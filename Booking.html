<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="/CSS/Booking.css" />
    <script src="JavaScript/scripts.js" defer></script>
    <link
      href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css"
      rel="stylesheet"
    />
    <title>Booking</title>
  </head>

  <body style="text-align: center">
    <h1 class="head">
      <a href="/index.html"
        ><span>Sn</span>eaky<span>K</span>leen<i
          ><sub
            ><small
              ><small><small>The Sneaker Cartel</small></small></small
            ></sub
          ></i
        ></a
      >
    </h1>
    <header class="header">
      <nav>
        <a href="index.html"><button class="animated-button">Home</button></a>
        <a href="About.html"><button class="animated-button">About</button></a>
        <a href="Services.html"
          ><button class="animated-button">Services</button></a
        >
        <a href="Booking.html"
          ><button class="animated-button">Booking</button></a
        >
        <a href="Contact.html"
          ><button class="animated-button">Contact</button></a
        >
      </nav>
    </header>

    <a id="back-to-top" href="#top">
      <button>&uarr;</button>
    </a>

    <div>
      <h1><u>Booking</u></h1>
      <br />
      <p>To book a shoe cleaning please fill this form out:</p>

      <form class="form">
        <div class="form-group">
          <label for="firstName">Full Name:</label>
          <input
            type="text"
            id="fullName"
            name="fullName"
            required
            placeholder="John Doe"
          />
        </div>

        <div class="form-group form-row">
          <div class="form-field">
            <label for="email">Email:</label>
            <input
              type="email"
              id="email"
              name="email"
              required
              placeholder="JohnDoe@gmail.com"
            />
          </div>
          <div class="form-field">
            <label for="phone">Phone Number:</label>
            <input
              type="tel"
              id="phone"
              name="phone"
              required
              placeholder="083-XXX-XXXX"
            />
          </div>
        </div>

        <div>
          <div class="form-field">
            <label for="shoe_type">Type of Sneakers:</label>
            <select
              name="shoe_type"
              id="shoe_type"
              required
              onchange="addBasicCleaning()"
            >
              <option value="">Select...</option>
              <option value="100">Canvas (R100)</option>
              <option value="120">Knit (R120)</option>
              <option value="150">Leather(R150)</option>
              <option value="80">Mesh(R80)</option>
              <option value="60">Rubber(R60)</option>
              <option value="180">Suede(R180)</option>
              <option value="80">Synthetic(R80)</option>
            </select>
          </div>
          <div class="form-field">
            <label for="serviceList">Type of Service:</label>
            <select name="serviceList" id="serviceSelect">
              <option value="">Select...</option>
              <option value="50">Deep Cleaning (R50)</option>
              <option value="100">Stain Removal (R100)</option>
              <option value="60">Water Proofing (R60)</option>
            </select>
            <button onclick="addService()">Add Service</button>
            <button onclick="removeService()">Remove Service</button>
          </div>
        </div>

        <h2>Selected Services</h2>
        <ul id="serviceList"></ul>

        <div class="form-group">
          <label for="fullCost">Total Cost:</label>
          <input type="text" id="fullCost" name="fullCost" readonly />
        </div>

        <div class="form-group form-row">
          <div class="form-field">
            <label for="dropoff_date">Preferred Drop-off Date:</label>
            <input type="date" id="dropoff_date" name="dropoff_date" required />
          </div>
          <div class="form-field">
            <label for="dropoff_time">Preferred Drop-off Time:</label>
            <input type="time" id="dropoff_time" name="dropoff_time" required />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group form-field" style="margin-left: 50px">
            <label for="dropoff_location">Preferred Drop-off Location:</label>
            <select name="dropoff_location" id="dropoff_location" required>
              <option value="">Select...</option>
              <option value="cape_town_cbd">Cape Town CBD</option>
              <option value="claremont">Claremont</option>
              <option value="seapoint">Sea Point</option>
              <option value="woodstock">Woodstock</option>
              <option value="bellville">Bellville</option>
            </select>
          </div>
        </div>

        <div class="buttons">
          <input type="submit" value="Submit Booking" />
          <input type="reset" value="Reset Form" />
        </div>
      </form>
      <br />
      <br />
      <p>SneakyKleen Headquarters Address:</p>
      <br />
      <iframe
        src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d827.5753902246475!2d18.46001556961473!3d-33.933371198325105!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x1dcc5db42c93a685%3A0xec815c21c6eaef71!2sCapaCiTi%20Tech%20Career%20Accelerator!5e0!3m2!1sen!2sza!4v1707829808041!5m2!1sen!2sza"
        width="645"
        height="350"
        style="border: 0"
        allowfullscreen=""
        loading="lazy"
        referrerpolicy="no-referrer-when-downgrade"
      ></iframe>
    </div>

    <br />

    <footer>
      <p><u>Interact with us and visit our socials:</u></p>

      <br />
      <span class="home-sci">
        <a href="https://www.facebook.com/login.php/"
          ><i class="bx bxl-facebook"></i
        ></a>
        <a href="https://twitter.com/?lang=en-za"
          ><i class="bx bxl-twitter"></i
        ></a>
        <a href="https://www.instagram.com/?hl=en"
          ><i class="bx bxl-instagram"></i
        ></a>
      </span>
      <p>&copy; 2024 SneakyKleen. All rights are reserved.</p>
    </footer>

    <!-- Payment Popup -->
    <div class="popup-overlay" id="popupOverlay"></div>
    <div class="popup" id="paymentPopup">
      <h2>Payment Details</h2>
      <form id="paymentForm">
        <label for="cardName">Cardholder Name:</label>
        <input type="text" id="cardName" name="cardName" required /><br /><br />
        <label for="cardNumber">Card Number:</label>
        <input
          type="text"
          id="cardNumber"
          name="cardNumber"
          required
        /><br /><br />
        <label for="expiryDate">Expiry Date:</label>
        <input
          type="text"
          id="expiryDate"
          name="expiryDate"
          placeholder="MM/YY"
          required
        /><br /><br />
        <label for="cvv">CVV:</label>
        <input type="text" id="cvv" name="cvv" required /><br /><br />
        <button type="button" onclick="processPayment()">Pay</button>
      </form>
    </div>

    <!-- Confirmation Popup -->
    <div class="popup" id="confirmationPopup">
      <h2>Booking Confirmed</h2>
      <p>Your booking has been confirmed.</p>
      <p>Order Number: <span id="orderNumber"></span></p>
      <button class="close-btn" onclick="closeConfirmationPopup()">
        Close
      </button>
    </div>

    <script>
      const services = {};
      const fullCostInput = document.getElementById("fullCost");
      let currentShoeType = "";

      function addBasicCleaning() {
        const shoeTypeSelect = document.getElementById("shoe_type");
        const selectedShoeType =
          shoeTypeSelect.options[shoeTypeSelect.selectedIndex].text;
        const cost = parseInt(shoeTypeSelect.value);

        if (selectedShoeType !== "Select...") {
          currentShoeType = selectedShoeType.split(" ")[0];
          services[currentShoeType] = {
            basicCleaning: {
              name: `Basic Cleaning (${currentShoeType})`,
              cost: cost,
            },
            additionalServices: [],
          };
          updateServiceList();
          calculateTotal();
        }
      }

      function addService() {
        if (!currentShoeType) {
          alert("Please select a shoe type first.");
          return;
        }

        const serviceSelect = document.getElementById("serviceSelect");
        const selectedService =
          serviceSelect.options[serviceSelect.selectedIndex];

        if (selectedService.value !== "") {
          const newService = {
            name: selectedService.text.split(" (")[0],
            cost: parseInt(selectedService.value),
          };

          services[currentShoeType].additionalServices.push(newService);
          updateServiceList();
          calculateTotal();
          serviceSelect.selectedIndex = 0;
        }
      }

      function removeService() {
        if (
          !currentShoeType ||
          services[currentShoeType].additionalServices.length === 0
        )
          return;
        services[currentShoeType].additionalServices.pop();
        updateServiceList();
        calculateTotal();
      }

      function updateServiceList() {
        const serviceList = document.getElementById("serviceList");
        serviceList.innerHTML = "";

        Object.keys(services).forEach((shoeType) => {
          const shoeServices = services[shoeType];
          const shoeTypeHeader = document.createElement("h3");
          shoeTypeHeader.textContent = `${shoeType} - ${shoeServices.basicCleaning.name} (R${shoeServices.basicCleaning.cost})`;
          serviceList.appendChild(shoeTypeHeader);

          shoeServices.additionalServices.forEach((service) => {
            const li = document.createElement("li");
            li.textContent = `${service.name} (R${service.cost})`;
            serviceList.appendChild(li);
          });
        });
      }

      function calculateTotal() {
        let totalCost = 0;
        Object.values(services).forEach((shoeServices) => {
          totalCost += shoeServices.basicCleaning.cost;
          shoeServices.additionalServices.forEach((service) => {
            totalCost += service.cost;
          });
        });
        fullCostInput.value = totalCost ? `R${totalCost}` : "R0";
      }

      function showPaymentPopup(event) {
        event.preventDefault(); // Prevent form submission
        const form = document.querySelector(".form");
        if (form.checkValidity() && Object.keys(services).length > 0) {
          document.getElementById("popupOverlay").style.display = "block";
          document.getElementById("paymentPopup").style.display = "block";
        } else {
          alert(
            "Please fill out all required fields and select at least one shoe type."
          );
        }
      }

      function processPayment() {
        const cardNumber = document.getElementById("cardNumber").value;
        const cardName = document.getElementById("cardName").value;
        const expiryDate = document.getElementById("expiryDate").value;
        const cvv = document.getElementById("cvv").value;

        if (!/^\d{16}$/.test(cardNumber)) {
          alert("Card number must be 16 digits.");
          return;
        }
        if (!/^[A-Za-z\s]+$/.test(cardName)) {
          alert("Cardholder name must contain only letters and spaces.");
          return;
        }
        if (!/^\d{2}\/\d{2}$/.test(expiryDate)) {
          alert("Expiry date must be in MM/YY format.");
          return;
        }
        if (!/^\d{3,4}$/.test(cvv)) {
          alert("CVV must be 3 or 4 digits.");
          return;
        }

        // Simulate payment processing
        setTimeout(() => {
          document.getElementById("paymentPopup").style.display = "none";
          showConfirmationPopup();
        }, 1000);
      }

      function showConfirmationPopup() {
        document.getElementById("popupOverlay").style.display = "none";
        document.getElementById("confirmationPopup").style.display = "block";
        document.getElementById("orderNumber").textContent = `#${Math.floor(
          Math.random() * 1000000
        )}`;
      }

      function closeConfirmationPopup() {
        document.getElementById("confirmationPopup").style.display = "none";
        window.location.reload();
      }

      // Event listeners
      document
        .getElementById("shoe_type")
        .addEventListener("change", addBasicCleaning);
      document
        .querySelector(".form")
        .addEventListener("submit", showPaymentPopup);
      document
        .querySelector('button[onclick="addService()"]')
        .addEventListener("click", function (event) {
          event.preventDefault();
          addService();
        });
      document
        .querySelector('button[onclick="removeService()"]')
        .addEventListener("click", function (event) {
          event.preventDefault();
          removeService();
        });
    </script>
  </body>
</html>
